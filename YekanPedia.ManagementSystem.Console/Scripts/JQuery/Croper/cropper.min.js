/*!
 * Cropper v2.2.0
 * https://github.com/fengyuanchen/cropper
 *
 * Copyright (c) 2014-2015 Fengyuan Chen and contributors
 * Released under the MIT license
 *
 * Date: 2015-12-06T07:06:12.378Z
 */
(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports=="object"?n(require("jquery")):n(jQuery)})(function(n){"use strict";function i(n){return typeof n=="number"&&!isNaN(n)}function l(n){return typeof n=="undefined"}function yt(n,t){var r=[];return i(t)&&r.push(t),r.slice.apply(n,r)}function pt(n,t){var i=yt(arguments,2);return function(){return n.apply(t,i.concat(yt(arguments)))}}function fr(n){var t=n.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return t&&(t[1]!==rt.protocol||t[2]!==rt.hostname||t[3]!==rt.port)}function er(n){var t="timestamp="+(new Date).getTime();return n+(n.indexOf("?")===-1?"?":"&")+t}function pi(n){return n?' crossOrigin="'+n+'"':""}function or(n,t){var i;if(n.naturalWidth)return t(n.naturalWidth,n.naturalHeight);i=document.createElement("img");i.onload=function(){t(this.width,this.height)};i.src=n.src}function wt(n){var t=[],r=n.rotate,u=n.scaleX,f=n.scaleY;return i(r)&&t.push("rotate("+r+"deg)"),i(u)&&i(f)&&t.push("scale("+u+","+f+")"),t.length?t.join(" "):"none"}function it(n,t){var r=c(n.degree)%180,s=(r>90?180-r:r)*Math.PI/180,u=rr(s),f=ur(s),e=n.width,h=n.height,l=n.aspectRatio,i,o;return t?(i=e/(f+u/l),o=i/l):(i=e*f+h*u,o=e*u+h*f),{width:i,height:o}}function sr(t,r){var h=n("<canvas>")[0],u=h.getContext("2d"),b=0,k=0,f=r.naturalWidth,e=r.naturalHeight,c=r.rotate,l=r.scaleX,a=r.scaleY,v=i(l)&&i(a)&&(l!==1||a!==1),y=i(c)&&c!==0,d=y||v,g=f,nt=e,p,w,s;return v&&(p=f/2,w=e/2),y&&(s=it({width:f,height:e,degree:c}),g=s.width,nt=s.height,p=s.width/2,w=s.height/2),h.width=g,h.height=nt,d&&(b=-f/2,k=-e/2,u.save(),u.translate(p,w)),y&&u.rotate(c*Math.PI/180),v&&u.scale(l,a),u.drawImage(t,o(b),o(k),o(f),o(e)),d&&u.restore(),h}function hr(n,t,i){var u="",r;for(r=t,i+=t;r<i;r++)u+=yi(n.getUint8(r));return u}function cr(n){var t=new ki(n),s=t.byteLength,l,a,u,h,r,c,f,e,i,o;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(i=2;i<s;){if(t.getUint8(i)===255&&t.getUint8(i+1)===225){f=i;break}i++}if(f&&(a=f+4,u=f+10,hr(t,a,4)==="Exif"&&(c=t.getUint16(u),r=c===18761,(r||c===19789)&&t.getUint16(u+2,r)===42&&(h=t.getUint32(u+4,r),h>=8&&(e=u+h)))),e)for(s=t.getUint16(e,r),o=0;o<s;o++)if(i=e+o*12+2,t.getUint16(i,r)===274){i+=8;l=t.getUint16(i,r);t.setUint16(i,1,r);break}return l}function s(t,i){this.$element=n(t);this.options=n.extend({},s.DEFAULTS,n.isPlainObject(i)&&i);this.isLoaded=!1;this.isBuilt=!1;this.isCompleted=!1;this.isRotated=!1;this.isCropped=!1;this.isDisabled=!1;this.isReplaced=!1;this.isLimited=!1;this.isImg=!1;this.originalUrl="";this.canvas=null;this.cropBox=null;this.init()}var bt=n(window),kt=n(document),rt=window.location,wi=window.ArrayBuffer,bi=window.Uint8Array,ki=window.DataView,di=window.btoa,f="cropper",a="cropper-modal",dt="cropper-hide",e="cropper-hidden",gi="cropper-invisible",ut="cropper-move",ft="cropper-crop",gt="cropper-disabled",nr="cropper-bg",ni="mousedown touchstart pointerdown MSPointerDown",ti="mousemove touchmove pointermove MSPointerMove",ii="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",ri="wheel mousewheel DOMMouseScroll",ui="dblclick",et="load."+f,fi="error."+f,ei="resize."+f,oi="build."+f,ot="built."+f,st="cropstart."+f,ht="cropmove."+f,ct="cropend."+f,k="crop."+f,lt="zoom."+f,tr=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,d="preview",v="action",si="e",hi="w",ci="s",li="n",y="se",p="sw",w="ne",b="nw",at="all",g="crop",nt="move",vt="zoom",ir="none",ai=n.isFunction(n("<canvas>")[0].getContext),u=Number,t=Math.min,r=Math.max,c=Math.abs,rr=Math.sin,ur=Math.cos,vi=Math.sqrt,tt=Math.round,o=Math.floor,h={version:"2.2.0"},yi=String.fromCharCode;n.extend(h,{init:function(){var n=this.$element,t;if(n.is("img")){if(this.isImg=!0,this.originalUrl=t=n.attr("src"),!t)return;t=n.prop("src")}else n.is("canvas")&&ai&&(t=n[0].toDataURL());this.load(t)},trigger:function(t,i){var r=n.Event(t,i);return this.$element.trigger(r),r},load:function(t){var r=this.options,f=this.$element,u,i;if(t){f.one(oi,r.build);if(!this.trigger(oi).isDefaultPrevented()){if(this.url=t,this.image={},!r.checkOrientation||!wi)return this.clone();u=n.proxy(this.read,this);i=new XMLHttpRequest;i.onload=function(){u(this.response)};i.open("get",t);i.responseType="arraybuffer";i.send()}}},read:function(t){var e=this.options,o=cr(t),r=this.image,s="",i,u,f;if(o){n.each(new bi(t),function(n,t){s+=yi(t)});this.url="data:image/jpeg;base64,"+di(s);switch(o){case 2:u=-1;break;case 3:i=-180;break;case 4:f=-1;break;case 5:i=90;f=-1;break;case 6:i=90;break;case 7:i=90;u=-1;break;case 8:i=-90}}e.rotatable&&(r.rotate=i);e.scalable&&(r.scaleX=u,r.scaleY=f);this.clone()},clone:function(){var e=this.options,i=this.$element,r=this.url,t="",u,f;if(e.checkCrossOrigin&&fr(r)&&(t=i.prop("crossOrigin"),t||(t="anonymous",u=er(r))),this.crossOrigin=t,this.crossOriginUrl=u,this.$clone=f=n("<img"+pi(t)+' src="'+(u||r)+'">'),this.isImg)if(i[0].complete)this.start();else i.one(et,n.proxy(this.start,this));else f.one(et,n.proxy(this.start,this)).one(fi,n.proxy(this.stop,this)).addClass(dt).insertAfter(i)},start:function(){var t=this.$element,i=this.$clone;this.isImg||(i.off(fi,this.stop),t=i);or(t[0],n.proxy(function(t,i){n.extend(this.image,{naturalWidth:t,naturalHeight:i,aspectRatio:t/i});this.isLoaded=!0;this.build()},this))},stop:function(){this.$clone.remove();this.$clone=null}});n.extend(h,{build:function(){var i=this.options,o=this.$element,c=this.$clone,u,f,h;if(this.isLoaded){this.isBuilt&&this.unbuild();this.$container=o.parent();this.$cropper=u=n(s.TEMPLATE);this.$canvas=u.find(".cropper-canvas").append(c);this.$dragBox=u.find(".cropper-drag-box");this.$cropBox=f=u.find(".cropper-crop-box");this.$viewBox=u.find(".cropper-view-box");this.$face=h=f.find(".cropper-face");o.addClass(e).after(u);this.isImg||c.removeClass(dt);this.initPreview();this.bind();i.aspectRatio=r(0,i.aspectRatio)||NaN;i.viewMode=r(0,t(3,tt(i.viewMode)))||0;i.autoCrop?(this.isCropped=!0,i.modal&&this.$dragBox.addClass(a)):f.addClass(e);i.guides||f.find(".cropper-dashed").addClass(e);i.center||f.find(".cropper-center").addClass(e);i.cropBoxMovable&&h.addClass(ut).data(v,at);i.highlight||h.addClass(gi);i.background&&u.addClass(nr);i.cropBoxResizable||f.find(".cropper-line, .cropper-point").addClass(e);this.setDragMode(i.dragMode);this.render();this.isBuilt=!0;this.setData(i.data);o.one(ot,i.built);setTimeout(n.proxy(function(){this.trigger(ot);this.isCompleted=!0},this),0)}},unbuild:function(){this.isBuilt&&(this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)}});n.extend(h,{render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.isCropped&&this.renderCropBox()},initContainer:function(){var t=this.options,i=this.$element,f=this.$container,n=this.$cropper;n.addClass(e);i.removeClass(e);n.css(this.container={width:r(f.width(),u(t.minContainerWidth)||200),height:r(f.height(),u(t.minContainerHeight)||100)});i.addClass(e);n.removeClass(e)},initCanvas:function(){var f=this.options.viewMode,h=this.container,r=h.width,u=h.height,e=this.image,l=e.naturalWidth,a=e.naturalHeight,v=c(e.rotate)===90,y=v?a:l,p=v?l:a,i=y/p,o=r,s=u,t;u*i>r?f===3?o=u*i:s=r/i:f===3?s=r/i:o=u*i;t={naturalWidth:y,naturalHeight:p,aspectRatio:i,width:o,height:s};t.oldLeft=t.left=(r-o)/2;t.oldTop=t.top=(u-s)/2;this.canvas=t;this.isLimited=f===1||f===2;this.limitCanvas(!0,!0);this.initialImage=n.extend({},e);this.initialCanvas=n.extend({},t)},limitCanvas:function(n,i){var w=this.options,c=w.viewMode,b=this.container,v=b.width,y=b.height,f=this.canvas,h=f.aspectRatio,s=this.cropBox,p=this.isCropped&&s,e,o,l,a;n&&(e=u(w.minCanvasWidth)||0,o=u(w.minCanvasHeight)||0,c&&(c>1?(e=r(e,v),o=r(o,y),c===3&&(o*h>e?e=o*h:o=e/h)):e?e=r(e,p?s.width:0):o?o=r(o,p?s.height:0):p&&(e=s.width,o=s.height,o*h>e?e=o*h:o=e/h)),e&&o?o*h>e?o=e/h:e=o*h:e?o=e/h:o&&(e=o*h),f.minWidth=e,f.minHeight=o,f.maxWidth=Infinity,f.maxHeight=Infinity);i&&(c?(l=v-f.width,a=y-f.height,f.minLeft=t(0,l),f.minTop=t(0,a),f.maxLeft=r(0,l),f.maxTop=r(0,a),p&&this.isLimited&&(f.minLeft=t(s.left,s.left+s.width-f.width),f.minTop=t(s.top,s.top+s.height-f.height),f.maxLeft=s.left,f.maxTop=s.top,c===2&&(f.width>=v&&(f.minLeft=t(0,l),f.maxLeft=r(0,l)),f.height>=y&&(f.minTop=t(0,a),f.maxTop=r(0,a))))):(f.minLeft=-f.width,f.minTop=-f.height,f.maxLeft=v,f.maxTop=y))},renderCanvas:function(n){var i=this.canvas,f=this.image,e=f.rotate,s=f.naturalWidth,h=f.naturalHeight,o,u;this.isRotated&&(this.isRotated=!1,u=it({width:f.width,height:f.height,degree:e}),o=u.width/u.height,o!==i.aspectRatio&&(i.left-=(u.width-i.width)/2,i.top-=(u.height-i.height)/2,i.width=u.width,i.height=u.height,i.aspectRatio=o,i.naturalWidth=s,i.naturalHeight=h,e%180&&(u=it({width:s,height:h,degree:e}),i.naturalWidth=u.width,i.naturalHeight=u.height),this.limitCanvas(!0,!1)));(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft);(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop);i.width=t(r(i.width,i.minWidth),i.maxWidth);i.height=t(r(i.height,i.minHeight),i.maxHeight);this.limitCanvas(!1,!0);i.oldLeft=i.left=t(r(i.left,i.minLeft),i.maxLeft);i.oldTop=i.top=t(r(i.top,i.minTop),i.maxTop);this.$canvas.css({width:i.width,height:i.height,left:i.left,top:i.top});this.renderImage();this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0);n&&this.output()},renderImage:function(t){var r=this.canvas,i=this.image,u;i.rotate&&(u=it({width:r.width,height:r.height,degree:i.rotate,aspectRatio:i.aspectRatio},!0));n.extend(i,u?{width:u.width,height:u.height,left:(r.width-u.width)/2,top:(r.height-u.height)/2}:{width:r.width,height:r.height,left:0,top:0});this.$clone.css({width:i.width,height:i.height,marginLeft:i.left,marginTop:i.top,transform:wt(i)});t&&this.output()},initCropBox:function(){var o=this.options,f=this.canvas,e=o.aspectRatio,s=u(o.autoCropArea)||.8,i={width:f.width,height:f.height};e&&(f.height*e>f.width?i.height=i.width/e:i.width=i.height*e);this.cropBox=i;this.limitCropBox(!0,!0);i.width=t(r(i.width,i.minWidth),i.maxWidth);i.height=t(r(i.height,i.minHeight),i.maxHeight);i.width=r(i.minWidth,i.width*s);i.height=r(i.minHeight,i.height*s);i.oldLeft=i.left=f.left+(f.width-i.width)/2;i.oldTop=i.top=f.top+(f.height-i.height)/2;this.initialCropBox=n.extend({},i)},limitCropBox:function(n,i){var y=this.options,s=y.aspectRatio,w=this.container,a=w.width,v=w.height,h=this.canvas,f=this.cropBox,p=this.isLimited,e,o,c,l;n&&(e=u(y.minCropBoxWidth)||0,o=u(y.minCropBoxHeight)||0,e=t(e,a),o=t(o,v),c=t(a,p?h.width:a),l=t(v,p?h.height:v),s&&(e&&o?o*s>e?o=e/s:e=o*s:e?o=e/s:o&&(e=o*s),l*s>c?l=c/s:c=l*s),f.minWidth=t(e,c),f.minHeight=t(o,l),f.maxWidth=c,f.maxHeight=l);i&&(p?(f.minLeft=r(0,h.left),f.minTop=r(0,h.top),f.maxLeft=t(a,h.left+h.width)-f.width,f.maxTop=t(v,h.top+h.height)-f.height):(f.minLeft=0,f.minTop=0,f.maxLeft=a-f.width,f.maxTop=v-f.height))},renderCropBox:function(){var i=this.options,u=this.container,f=u.width,e=u.height,n=this.cropBox;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft);(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop);n.width=t(r(n.width,n.minWidth),n.maxWidth);n.height=t(r(n.height,n.minHeight),n.maxHeight);this.limitCropBox(!1,!0);n.oldLeft=n.left=t(r(n.left,n.minLeft),n.maxLeft);n.oldTop=n.top=t(r(n.top,n.minTop),n.maxTop);i.movable&&i.cropBoxMovable&&this.$face.data(v,n.width===f&&n.height===e?nt:at);this.$cropBox.css({width:n.width,height:n.height,left:n.left,top:n.top});this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0);this.isDisabled||this.output()},output:function(){if(this.preview(),this.isCompleted)this.trigger(k,this.getData());else if(!this.isBuilt)this.$element.one(ot,n.proxy(function(){this.trigger(k,this.getData())},this))}});n.extend(h,{initPreview:function(){var t=pi(this.crossOrigin),i=t?this.crossOriginUrl:this.url;this.$preview=n(this.options.preview);this.$viewBox.html("<img"+t+' src="'+i+'">');this.$preview.each(function(){var r=n(this);r.data(d,{width:r.width(),height:r.height(),html:r.html()});r.html("<img"+t+' src="'+i+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var i=n(this),t=i.data(d);i.css({width:t.width,height:t.height}).html(t.html).removeData(d)})},preview:function(){var t=this.image,f=this.canvas,i=this.cropBox,r=i.width,u=i.height,e=t.width,o=t.height,s=i.left-f.left-t.left,h=i.top-f.top-t.top;this.isCropped&&!this.isDisabled&&(this.$viewBox.find("img").css({width:e,height:o,marginLeft:-s,marginTop:-h,transform:wt(t)}),this.$preview.each(function(){var l=n(this),a=l.data(d),v=a.width,f=a.height,y=v,c=f,i=1;r&&(i=v/r,c=u*i);u&&c>f&&(i=f/u,y=r*i,c=f);l.css({width:y,height:c}).find("img").css({width:e*i,height:o*i,marginLeft:-s*i,marginTop:-h*i,transform:wt(t)})}))}});n.extend(h,{bind:function(){var t=this.options,i=this.$element,r=this.$cropper;if(n.isFunction(t.cropstart))i.on(st,t.cropstart);if(n.isFunction(t.cropmove))i.on(ht,t.cropmove);if(n.isFunction(t.cropend))i.on(ct,t.cropend);if(n.isFunction(t.crop))i.on(k,t.crop);if(n.isFunction(t.zoom))i.on(lt,t.zoom);r.on(ni,n.proxy(this.cropStart,this));if(t.zoomable&&t.zoomOnWheel)r.on(ri,n.proxy(this.wheel,this));if(t.toggleDragModeOnDblclick)r.on(ui,n.proxy(this.dblclick,this));kt.on(ti,this._cropMove=pt(this.cropMove,this)).on(ii,this._cropEnd=pt(this.cropEnd,this));if(t.responsive)bt.on(ei,this._resize=pt(this.resize,this))},unbind:function(){var t=this.options,i=this.$element,r=this.$cropper;n.isFunction(t.cropstart)&&i.off(st,t.cropstart);n.isFunction(t.cropmove)&&i.off(ht,t.cropmove);n.isFunction(t.cropend)&&i.off(ct,t.cropend);n.isFunction(t.crop)&&i.off(k,t.crop);n.isFunction(t.zoom)&&i.off(lt,t.zoom);r.off(ni,this.cropStart);t.zoomable&&t.zoomOnWheel&&r.off(ri,this.wheel);t.toggleDragModeOnDblclick&&r.off(ui,this.dblclick);kt.off(ti,this._cropMove).off(ii,this._cropEnd);t.responsive&&bt.off(ei,this._resize)}});n.extend(h,{resize:function(){var f=this.options.restore,e=this.$container,i=this.container,r,u,t;!this.isDisabled&&i&&(t=e.width()/i.width,(t!==1||e.height()!==i.height)&&(f&&(r=this.getCanvasData(),u=this.getCropBoxData()),this.render(),f&&(this.setCanvasData(n.each(r,function(n,i){r[n]=i*t})),this.setCropBoxData(n.each(u,function(n,i){u[n]=i*t})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(ft)?this.setDragMode(nt):this.setDragMode(g))},wheel:function(n){var r=n.originalEvent,t=r||n,f=u(this.options.wheelZoomRatio)||.1,i=1;this.isDisabled||(n.preventDefault(),t.deltaY?i=t.deltaY>0?1:-1:t.wheelDelta?i=-t.wheelDelta/120:t.detail&&(i=t.detail>0?1:-1),this.zoom(-i*f,r))},cropStart:function(t){var o=this.options,i=t.originalEvent,f=i&&i.touches,r=t,e,u;if(!this.isDisabled){if(f){if(e=f.length,e>1)if(o.zoomable&&o.zoomOnTouch&&e===2)r=f[1],this.startX2=r.pageX,this.startY2=r.pageY,u=vt;else return;r=f[0]}if(u=u||n(r.target).data(v),tr.test(u)){if(this.trigger(st,{originalEvent:i,action:u}).isDefaultPrevented())return;t.preventDefault();this.action=u;this.cropping=!1;this.startX=r.pageX||i&&i.pageX;this.startY=r.pageY||i&&i.pageY;u===g&&(this.cropping=!0,this.$dragBox.addClass(a))}}},cropMove:function(n){var e=this.options,t=n.originalEvent,r=t&&t.touches,i=n,u=this.action,f;if(!this.isDisabled){if(r){if(f=r.length,f>1)if(e.zoomable&&e.zoomOnTouch&&f===2)i=r[1],this.endX2=i.pageX,this.endY2=i.pageY;else return;i=r[0]}if(u){if(this.trigger(ht,{originalEvent:t,action:u}).isDefaultPrevented())return;n.preventDefault();this.endX=i.pageX||t&&t.pageX;this.endY=i.pageY||t&&t.pageY;this.change(i.shiftKey,u===vt?t:null)}}},cropEnd:function(n){var i=n.originalEvent,t=this.action;this.isDisabled||t&&(n.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(a,this.isCropped&&this.options.modal)),this.action="",this.trigger(ct,{originalEvent:i,action:t}))}});n.extend(h,{change:function(n,i){var st=this.options,o=st.aspectRatio,l=this.action,ft=this.container,ot=this.canvas,v=this.cropBox,u=v.width,f=v.height,h=v.left,s=v.top,ut=h+u,tt=s+f,it=0,k=0,rt=ft.width,d=ft.height,a=!0,et,r;!o&&n&&(o=u&&f?u/f:1);this.limited&&(it=v.minLeft,k=v.minTop,rt=it+t(ft.width,ot.width),d=k+t(ft.height,ot.height));r={x:this.endX-this.startX,y:this.endY-this.startY};o&&(r.X=r.y*o,r.Y=r.x/o);switch(l){case at:h+=r.x;s+=r.y;break;case si:if(r.x>=0&&(ut>=rt||o&&(s<=k||tt>=d))){a=!1;break}u+=r.x;o&&(f=u/o,s-=r.Y/2);u<0&&(l=hi,u=0);break;case li:if(r.y<=0&&(s<=k||o&&(h<=it||ut>=rt))){a=!1;break}f-=r.y;s+=r.y;o&&(u=f*o,h+=r.X/2);f<0&&(l=ci,f=0);break;case hi:if(r.x<=0&&(h<=it||o&&(s<=k||tt>=d))){a=!1;break}u-=r.x;h+=r.x;o&&(f=u/o,s+=r.Y/2);u<0&&(l=si,u=0);break;case ci:if(r.y>=0&&(tt>=d||o&&(h<=it||ut>=rt))){a=!1;break}f+=r.y;o&&(u=f*o,h-=r.X/2);f<0&&(l=li,f=0);break;case w:if(o){if(r.y<=0&&(s<=k||ut>=rt)){a=!1;break}f-=r.y;s+=r.y;u=f*o}else r.x>=0?ut<rt?u+=r.x:r.y<=0&&s<=k&&(a=!1):u+=r.x,r.y<=0?s>k&&(f-=r.y,s+=r.y):(f-=r.y,s+=r.y);u<0&&f<0?(l=p,f=0,u=0):u<0?(l=b,u=0):f<0&&(l=y,f=0);break;case b:if(o){if(r.y<=0&&(s<=k||h<=it)){a=!1;break}f-=r.y;s+=r.y;u=f*o;h+=r.X}else r.x<=0?h>it?(u-=r.x,h+=r.x):r.y<=0&&s<=k&&(a=!1):(u-=r.x,h+=r.x),r.y<=0?s>k&&(f-=r.y,s+=r.y):(f-=r.y,s+=r.y);u<0&&f<0?(l=y,f=0,u=0):u<0?(l=w,u=0):f<0&&(l=p,f=0);break;case p:if(o){if(r.x<=0&&(h<=it||tt>=d)){a=!1;break}u-=r.x;h+=r.x;f=u/o}else r.x<=0?h>it?(u-=r.x,h+=r.x):r.y>=0&&tt>=d&&(a=!1):(u-=r.x,h+=r.x),r.y>=0?tt<d&&(f+=r.y):f+=r.y;u<0&&f<0?(l=w,f=0,u=0):u<0?(l=y,u=0):f<0&&(l=b,f=0);break;case y:if(o){if(r.x>=0&&(ut>=rt||tt>=d)){a=!1;break}u+=r.x;f=u/o}else r.x>=0?ut<rt?u+=r.x:r.y>=0&&tt>=d&&(a=!1):u+=r.x,r.y>=0?tt<d&&(f+=r.y):f+=r.y;u<0&&f<0?(l=b,f=0,u=0):u<0?(l=p,u=0):f<0&&(l=w,f=0);break;case nt:this.move(r.x,r.y);a=!1;break;case vt:this.zoom(function(n,t,i,r){var u=vi(n*n+t*t),f=vi(i*i+r*r);return(f-u)/u}(c(this.startX-this.startX2),c(this.startY-this.startY2),c(this.endX-this.endX2),c(this.endY-this.endY2)),i);this.startX2=this.endX2;this.startY2=this.endY2;a=!1;break;case g:if(!r.x||!r.y){a=!1;break}et=this.$cropper.offset();h=this.startX-et.left;s=this.startY-et.top;u=v.minWidth;f=v.minHeight;r.x>0?l=r.y>0?y:w:r.x<0&&(h-=u,l=r.y>0?p:b);r.y<0&&(s-=f);this.isCropped||(this.$cropBox.removeClass(e),this.isCropped=!0,this.limited&&this.limitCropBox(!0,!0))}a&&(v.width=u,v.height=f,v.left=h,v.top=s,this.action=l,this.renderCropBox());this.startX=this.endX;this.startY=this.endY}});n.extend(h,{crop:function(){this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(a),this.$cropBox.removeClass(e)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.isBuilt&&!this.isDisabled&&(this.image=n.extend({},this.initialImage),this.canvas=n.extend({},this.initialCanvas),this.cropBox=n.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){this.isCropped&&!this.isDisabled&&(n.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(a),this.$cropBox.addClass(e))},replace:function(n){!this.isDisabled&&n&&(this.isImg&&(this.isReplaced=!0,this.$element.attr("src",n)),this.options.data=null,this.load(n))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(gt))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(gt))},destroy:function(){var n=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&n.attr("src",this.originalUrl),this.unbuild(),n.removeClass(e)):this.isImg?n.off(et,this.start):this.$clone&&this.$clone.remove();n.removeData(f)},move:function(n,t){var i=this.canvas;this.moveTo(l(n)?n:i.left+u(n),l(t)?t:i.top+u(t))},moveTo:function(n,t){var f=this.canvas,r=!1;l(t)&&(t=n);n=u(n);t=u(t);this.isBuilt&&!this.isDisabled&&this.options.movable&&(i(n)&&(f.left=n,r=!0),i(t)&&(f.top=t,r=!0),r&&this.renderCanvas(!0))},zoom:function(n,t){var i=this.canvas;n=u(n);n=n<0?1/(1-n):1+n;this.zoomTo(i.width*n/i.naturalWidth,t)},zoomTo:function(n,t){var s=this.options,i=this.canvas,o=i.width,h=i.height,f=i.naturalWidth,c=i.naturalHeight,r,e;if(n=u(n),n>=0&&this.isBuilt&&!this.isDisabled&&s.zoomable){if(r=f*n,e=c*n,this.trigger(lt,{originalEvent:t,oldRatio:o/f,ratio:r/f}).isDefaultPrevented())return;i.left-=(r-o)/2;i.top-=(e-h)/2;i.width=r;i.height=e;this.renderCanvas(!0)}},rotate:function(n){this.rotateTo((this.image.rotate||0)+u(n))},rotateTo:function(n){n=u(n);i(n)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=n%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(n,t){var f=this.image,r=!1;l(t)&&(t=n);n=u(n);t=u(t);this.isBuilt&&!this.isDisabled&&this.options.scalable&&(i(n)&&(f.scaleX=n,r=!0),i(t)&&(f.scaleY=t,r=!0),r&&this.renderImage(!0))},scaleX:function(n){var t=this.image.scaleY;this.scale(n,i(t)?t:1)},scaleY:function(n){var t=this.image.scaleX;this.scale(i(t)?t:1,n)},getData:function(t){var f=this.options,r=this.image,e=this.canvas,u=this.cropBox,o,i;return this.isBuilt&&this.isCropped?(i={x:u.left-e.left,y:u.top-e.top,width:u.width,height:u.height},o=r.width/r.naturalWidth,n.each(i,function(n,r){r=r/o;i[n]=t?tt(r):r})):i={x:0,y:0,width:0,height:0},f.rotatable&&(i.rotate=r.rotate||0),f.scalable&&(i.scaleX=r.scaleX||1,i.scaleY=r.scaleY||1),i},setData:function(t){var o=this.options,r=this.image,s=this.canvas,u={},h,e,f;n.isFunction(t)&&(t=t.call(this.element));this.isBuilt&&!this.isDisabled&&n.isPlainObject(t)&&(o.rotatable&&i(t.rotate)&&t.rotate!==r.rotate&&(r.rotate=t.rotate,this.isRotated=h=!0),o.scalable&&(i(t.scaleX)&&t.scaleX!==r.scaleX&&(r.scaleX=t.scaleX,e=!0),i(t.scaleY)&&t.scaleY!==r.scaleY&&(r.scaleY=t.scaleY,e=!0)),h?this.renderCanvas():e&&this.renderImage(),f=r.width/r.naturalWidth,i(t.x)&&(u.left=t.x*f+s.left),i(t.y)&&(u.top=t.y*f+s.top),i(t.width)&&(u.width=t.width*f),i(t.height)&&(u.height=t.height*f),this.setCropBoxData(u))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var i=this.canvas,t={};return this.isBuilt&&n.each(["left","top","width","height","naturalWidth","naturalHeight"],function(n,r){t[r]=i[r]}),t},setCanvasData:function(t){var r=this.canvas,u=r.aspectRatio;n.isFunction(t)&&(t=t.call(this.$element));this.isBuilt&&!this.isDisabled&&n.isPlainObject(t)&&(i(t.left)&&(r.left=t.left),i(t.top)&&(r.top=t.top),i(t.width)?(r.width=t.width,r.height=t.width/u):i(t.height)&&(r.height=t.height,r.width=t.height*u),this.renderCanvas(!0))},getCropBoxData:function(){var n=this.cropBox,t;return this.isBuilt&&this.isCropped&&(t={left:n.left,top:n.top,width:n.width,height:n.height}),t||{}},setCropBoxData:function(t){var r=this.cropBox,u=this.options.aspectRatio,f,e;n.isFunction(t)&&(t=t.call(this.$element));this.isBuilt&&this.isCropped&&!this.isDisabled&&n.isPlainObject(t)&&(i(t.left)&&(r.left=t.left),i(t.top)&&(r.top=t.top),i(t.width)&&t.width!==r.width&&(f=!0,r.width=t.width),i(t.height)&&t.height!==r.height&&(e=!0,r.height=t.height),u&&(f?r.height=r.width/u:e&&(r.width=r.height*u)),this.renderCropBox())},getCroppedCanvas:function(i){var r,u,a,v,e,s,f,y,h,c,l;if(this.isBuilt&&this.isCropped&&ai)return n.isPlainObject(i)||(i={}),l=this.getData(),r=l.width,u=l.height,y=r/u,n.isPlainObject(i)&&(e=i.width,s=i.height,e?(s=e/y,f=e/r):s&&(e=s*y,f=s/u)),a=tt(e||r),v=tt(s||u),h=n("<canvas>")[0],h.width=a,h.height=v,c=h.getContext("2d"),i.fillColor&&(c.fillStyle=i.fillColor,c.fillRect(0,0,a,v)),c.drawImage.apply(c,function(){var w=sr(this.$clone[0],this.image),v=w.width,y=w.height,b=[w],n=l.x,i=l.y,h,p,c,a,e,s;return n<=-r||n>v?n=h=c=e=0:n<=0?(c=-n,n=0,h=e=t(v,r+n)):n<=v&&(c=0,h=e=t(r,v-n)),h<=0||i<=-u||i>y?i=p=a=s=0:i<=0?(a=-i,i=0,p=s=t(y,u+i)):i<=y&&(a=0,p=s=t(u,y-i)),b.push(o(n),o(i),o(h),o(p)),f&&(c*=f,a*=f,e*=f,s*=f),e>0&&s>0&&b.push(o(c),o(a),o(e),o(s)),b}.call(this)),h},setAspectRatio:function(n){var t=this.options;this.isDisabled||l(n)||(t.aspectRatio=r(0,n)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(n){var r=this.options,t,i;this.isLoaded&&!this.isDisabled&&(t=n===g,i=r.movable&&n===nt,n=t||i?n:ir,this.$dragBox.data(v,n).toggleClass(ft,t).toggleClass(ut,i),r.cropBoxMovable||this.$face.data(v,n).toggleClass(ft,t).toggleClass(ut,i))}});n.extend(s.prototype,h);s.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null};s.setDefaults=function(t){n.extend(s.DEFAULTS,t)};s.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"><\/div><\/div><div class="cropper-drag-box"><\/div><div class="cropper-crop-box"><span class="cropper-view-box"><\/span><span class="cropper-dashed dashed-h"><\/span><span class="cropper-dashed dashed-v"><\/span><span class="cropper-center"><\/span><span class="cropper-face"><\/span><span class="cropper-line line-e" data-action="e"><\/span><span class="cropper-line line-n" data-action="n"><\/span><span class="cropper-line line-w" data-action="w"><\/span><span class="cropper-line line-s" data-action="s"><\/span><span class="cropper-point point-e" data-action="e"><\/span><span class="cropper-point point-n" data-action="n"><\/span><span class="cropper-point point-w" data-action="w"><\/span><span class="cropper-point point-s" data-action="s"><\/span><span class="cropper-point point-ne" data-action="ne"><\/span><span class="cropper-point point-nw" data-action="nw"><\/span><span class="cropper-point point-sw" data-action="sw"><\/span><span class="cropper-point point-se" data-action="se"><\/span><\/div><\/div>';s.other=n.fn.cropper;n.fn.cropper=function(t){var r=yt(arguments,1),i;return this.each(function(){var e=n(this),u=e.data(f),o;if(!u){if(/destroy/.test(t))return;e.data(f,u=new s(this,t))}typeof t=="string"&&n.isFunction(o=u[t])&&(i=o.apply(u,r))}),l(i)?this:i};n.fn.cropper.Constructor=s;n.fn.cropper.setDefaults=s.setDefaults;n.fn.cropper.noConflict=function(){return n.fn.cropper=s.other,this}});